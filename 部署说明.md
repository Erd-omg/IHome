# IHomeå®¿èˆç®¡ç†ç³»ç»Ÿ - éƒ¨ç½²è¯´æ˜

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### æ–¹å¼ä¸€ï¼šDockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

#### 1. ç¯å¢ƒè¦æ±‚
- Docker 20.0+
- Docker Compose 2.0+

#### 2. ä¸€é”®éƒ¨ç½²
```bash
# å…‹éš†é¡¹ç›®
git clone <é¡¹ç›®åœ°å€>
cd IHome

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

#### 3. è®¿é—®ç³»ç»Ÿ
- å‰ç«¯åœ°å€: http://localhost:5173
- åç«¯åœ°å€: http://localhost:8080/api
- APIæ–‡æ¡£: http://localhost:8080/api/swagger-ui.html

### æ–¹å¼äºŒï¼šä¼ ç»Ÿéƒ¨ç½²

#### 1. ç¯å¢ƒè¦æ±‚
- JDK 17+
- Node.js 16+
- MySQL 8.0+
- Maven 3.6+

#### 2. æ•°æ®åº“åˆå§‹åŒ–
```bash
# åˆ›å»ºæ•°æ®åº“
mysql -u root -p
CREATE DATABASE ihome CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

# å¯¼å…¥æ•°æ®
mysql -u root -p ihome < backend/src/main/resources/db-init.sql
mysql -u root -p ihome < backend/src/main/resources/mock-data-complete.sql
```

#### 3. åç«¯éƒ¨ç½²
```bash
cd backend

# ä¿®æ”¹é…ç½®æ–‡ä»¶
vim src/main/resources/application.yml
# ä¿®æ”¹æ•°æ®åº“è¿æ¥ä¿¡æ¯

# æ„å»ºå¹¶å¯åŠ¨
mvn clean package -DskipTests
java -jar target/ihome-0.0.1-SNAPSHOT.jar
```

#### 4. å‰ç«¯éƒ¨ç½²
```bash
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¼€å‘ç¯å¢ƒå¯åŠ¨
npm run dev

# ç”Ÿäº§ç¯å¢ƒæ„å»º
npm run build
npm run preview
```

### æ–¹å¼ä¸‰ï¼šè„šæœ¬éƒ¨ç½²

#### Windowsç³»ç»Ÿ
```bash
# åˆå§‹åŒ–æ•°æ®åº“
init-database.bat

# å¯åŠ¨ç³»ç»Ÿ
start-system.bat
```

#### Linux/macOSç³»ç»Ÿ
```bash
# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x *.sh

# å¯åŠ¨ç³»ç»Ÿ
./start-system.sh

# åœæ­¢ç³»ç»Ÿ
./stop-system.sh
```

---

## ğŸ”§ é…ç½®è¯´æ˜

### 1. æ•°æ®åº“é…ç½®
```yaml
# backend/src/main/resources/application.yml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/ihome?useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true&useUnicode=true&characterEncoding=utf8&autoReconnect=true
    username: root
    password: your_password
    driver-class-name: com.mysql.cj.jdbc.Driver
```

### 2. å‰ç«¯é…ç½®
```env
# frontend/.env
VITE_API_BASE=http://localhost:8080/api
VITE_USE_MOCK=false
```

### 3. JWTé…ç½®
```yaml
# backend/src/main/resources/application.yml
jwt:
  secret: your-secret-key-here
  expiration: 600000  # 10åˆ†é’Ÿ
  refresh-expiration: 604800000  # 7å¤©
```

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. å¥åº·æ£€æŸ¥
```bash
# åç«¯å¥åº·æ£€æŸ¥
curl http://localhost:8080/api/health

# é¢„æœŸè¿”å›
{"code":0,"message":"success","data":"OK"}
```

### 2. åŠŸèƒ½æµ‹è¯•
- è®¿é—®å‰ç«¯: http://localhost:5173
- ä½¿ç”¨æµ‹è¯•è´¦å·ç™»å½•:
  - å­¦ç”Ÿ: 2024001 / 123456
  - ç®¡ç†å‘˜: A001 / 123456

### 3. APIæµ‹è¯•
- è®¿é—®Swaggeræ–‡æ¡£: http://localhost:8080/api/swagger-ui.html
- ä½¿ç”¨Postmanå¯¼å…¥APIé›†åˆè¿›è¡Œæµ‹è¯•

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“ä¼˜åŒ–
```sql
-- æ·»åŠ ç´¢å¼•
CREATE INDEX idx_student_id ON students(id);
CREATE INDEX idx_dormitory_id ON dormitories(id);
CREATE INDEX idx_allocation_student ON dormitory_allocations(student_id);
```

### 2. åº”ç”¨ä¼˜åŒ–
```yaml
# è¿æ¥æ± é…ç½®
spring:
  datasource:
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
```

### 3. å‰ç«¯ä¼˜åŒ–
```javascript
// å¯ç”¨ç”Ÿäº§æ¨¡å¼
npm run build
npm run preview
```

---

## ğŸ”’ å®‰å…¨é…ç½®

### 1. æ•°æ®åº“å®‰å…¨
```sql
-- åˆ›å»ºä¸“ç”¨ç”¨æˆ·
CREATE USER 'ihome_user'@'localhost' IDENTIFIED BY 'strong_password';
GRANT SELECT, INSERT, UPDATE, DELETE ON ihome.* TO 'ihome_user'@'localhost';
FLUSH PRIVILEGES;
```

### 2. åº”ç”¨å®‰å…¨
```yaml
# ä¿®æ”¹JWTå¯†é’¥
jwt:
  secret: your-very-long-and-secure-secret-key-here

# å¯ç”¨HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
server:
  ssl:
    enabled: true
    key-store: classpath:keystore.p12
    key-store-password: your-keystore-password
```

### 3. é˜²ç«å¢™é…ç½®
```bash
# åªå¼€æ”¾å¿…è¦ç«¯å£
ufw allow 22    # SSH
ufw allow 80    # HTTP
ufw allow 443   # HTTPS
ufw enable
```

---

## ğŸ“ æ—¥å¿—ç®¡ç†

### 1. åº”ç”¨æ—¥å¿—
```yaml
# æ—¥å¿—é…ç½®
logging:
  level:
    root: info
    com.ihome: debug
  file:
    name: logs/ihome.log
  pattern:
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
```

### 2. æ—¥å¿—è½®è½¬
```bash
# ä½¿ç”¨logrotate
sudo vim /etc/logrotate.d/ihome

# é…ç½®å†…å®¹
/var/log/ihome/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 root root
}
```

---

## ğŸš¨ æ•…éšœæ’é™¤

### 1. å¸¸è§é—®é¢˜

#### æ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥MySQLæœåŠ¡
systemctl status mysql

# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep 3306

# æ£€æŸ¥é˜²ç«å¢™
ufw status
```

#### ç«¯å£å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :8080
lsof -i :5173

# æ€æ­»è¿›ç¨‹
kill -9 <PID>
```

#### å†…å­˜ä¸è¶³
```bash
# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h

# å¢åŠ JVMå†…å­˜
java -Xms512m -Xmx1024m -jar target/ihome-0.0.1-SNAPSHOT.jar
```

### 2. æ—¥å¿—æŸ¥çœ‹
```bash
# åº”ç”¨æ—¥å¿—
tail -f logs/ihome.log

# Dockeræ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f frontend
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### 1. è”ç³»æ–¹å¼
- é‚®ç®±: support@ihome.com
- æ–‡æ¡£: https://docs.ihome.com
- é—®é¢˜åé¦ˆ: https://github.com/ihome/issues

### 2. å¸¸è§é—®é¢˜
- æŸ¥çœ‹FAQæ–‡æ¡£
- æœç´¢å·²çŸ¥é—®é¢˜
- æäº¤æ–°é—®é¢˜

---

**æœ€åæ›´æ–°**: 2025-01-27  
**ç‰ˆæœ¬**: v1.0  
**ç»´æŠ¤è€…**: IHomeå¼€å‘å›¢é˜Ÿ
